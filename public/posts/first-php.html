<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>前后端分离实现简易备忘系统 | llyのblog</title>
    <meta name="description" content=" 本博客将介绍简易备忘系统的前后端分离实现。 [备忘](./firstphp/he2h6k.png) 由于本人此时只学了一点点前端，后端的 php 都是凭感觉查的文档，本篇博客仅记录学习及实现过程，可能代码确实写的很烂（） 问题分解 本人的备忘功能是打算放在自己的一个静态导航网页上的，由于网页的其他部分都是静态的，且部">
    <meta property="og:type" content="article">
    <meta property="og:title" content="前后端分离实现简易备忘系统">
    <meta property="og:locale" content="zh_CN">
    <meta property="article:author" content="liuly">
    <meta property="article:tag" content="php">
    
  </head>
  <body>
    <main style="display: none;">
      <p>本博客将介绍简易备忘系统的前后端分离实现。</p>
<p><img src="/images/he2h6k.png" alt="备忘" width="471" height="210"></p>
<p>由于本人此时只学了一点点前端，后端的 php 都是凭感觉查的文档，本篇博客仅记录学习及实现过程，可能代码确实写的很烂（）</p>
<h2 id="%E9%97%AE%E9%A2%98%E5%88%86%E8%A7%A3" tabindex="-1">问题分解</h2>
<p>本人的备忘功能是打算放在自己的一个静态导航网页上的，由于网页的其他部分都是静态的，且部署在学校的服务器上（不提供后端程序运行），再加上本人目前主要在学前端，因此这里打算使用前后端分离的方式完成，只需要后端提供好接口，前端再调用就可以了。</p>
<p>于是问题主要被分解成了：</p>
<ul>
<li>前端 HTML 和 CSS 的实现</li>
<li>通过 JS 调用后端接口</li>
<li>后端 php 接口的实现</li>
</ul>
<p>下面将逐一介绍。</p>
<!-- more -->
<h2 id="%E5%89%8D%E7%AB%AF-html-%E5%92%8C-css-%E7%9A%84%E5%AE%9E%E7%8E%B0" tabindex="-1">前端 HTML 和 CSS 的实现</h2>
<p>本人的网页主要由 <a href="https://ustc.life/" target="_blank" rel="noopener">USTC 导航</a>修改而来。采用了列布局：</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-css"><span class="line"><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">main</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">  margin</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 10</span><span style="color:#AB5959;--shiki-dark:#CB7676">px</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">  overflow</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#A65E2B;--shiki-dark:#C99076"> hidden</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">  columns</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 3</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 350</span><span style="color:#AB5959;--shiki-dark:#CB7676">px</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span></code></pre>
<p>以到达自适应效果。</p>
<p><img src="/images/iakizk.png" alt="响应式布局 1" width="366" height="723">
<img src="/images/iakldy.png" alt="响应式布局 2" width="766" height="707">
<img src="/images/iakhwa.png" alt="响应式布局 3" width="1401" height="719"></p>
<p>于是对于备忘，增加一个 main-block 即可。（这样就会自动适应）</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-html"><span class="line"><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#1E754F;--shiki-dark:#4D9375">div</span><span style="color:#B07D48;--shiki-dark:#BD976A"> class</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">main-block</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">></span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">  &#x3C;</span><span style="color:#1E754F;--shiki-dark:#4D9375">span</span><span style="color:#B07D48;--shiki-dark:#BD976A"> class</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">block-title</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">></span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">备忘</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;/</span><span style="color:#1E754F;--shiki-dark:#4D9375">span</span><span style="color:#999999;--shiki-dark:#666666">></span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">  &#x3C;</span><span style="color:#1E754F;--shiki-dark:#4D9375">ul</span><span style="color:#B07D48;--shiki-dark:#BD976A"> id</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">todo-list</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">>&#x3C;/</span><span style="color:#1E754F;--shiki-dark:#4D9375">ul</span><span style="color:#999999;--shiki-dark:#666666">></span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">&#x3C;/</span><span style="color:#1E754F;--shiki-dark:#4D9375">div</span><span style="color:#999999;--shiki-dark:#666666">></span></span></code></pre>
<p>ul 中的内容要等待 JS 添加。</p>
<h2 id="%E9%80%9A%E8%BF%87-js-%E8%B0%83%E7%94%A8%E5%90%8E%E7%AB%AF%E6%8E%A5%E5%8F%A3" tabindex="-1">通过 JS 调用后端接口</h2>
<p>首先要完成的是从后端读取备忘信息。</p>
<p>那么需要约定数据格式。这里约定 JSON 格式。</p>
<p>大体如下：</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-json"><span class="line"><span style="color:#999999;--shiki-dark:#666666">{</span></span>
<span class="line"><span style="color:#99841877;--shiki-dark:#B8A96577">  "</span><span style="color:#998418;--shiki-dark:#B8A965">length</span><span style="color:#99841877;--shiki-dark:#B8A96577">"</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 3</span><span style="color:#999999;--shiki-dark:#666666">,</span></span>
<span class="line"><span style="color:#99841877;--shiki-dark:#B8A96577">  "</span><span style="color:#998418;--shiki-dark:#B8A965">events</span><span style="color:#99841877;--shiki-dark:#B8A96577">"</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#999999;--shiki-dark:#666666"> [</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    {</span><span style="color:#99841877;--shiki-dark:#B8A96577"> "</span><span style="color:#998418;--shiki-dark:#B8A965">content</span><span style="color:#99841877;--shiki-dark:#B8A96577">"</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">事件 1</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> },</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    {</span><span style="color:#99841877;--shiki-dark:#B8A96577"> "</span><span style="color:#998418;--shiki-dark:#B8A965">content</span><span style="color:#99841877;--shiki-dark:#B8A96577">"</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">事件 2</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> },</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    {</span><span style="color:#99841877;--shiki-dark:#B8A96577"> "</span><span style="color:#998418;--shiki-dark:#B8A965">content</span><span style="color:#99841877;--shiki-dark:#B8A96577">"</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">事件 3</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">  ]</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span></code></pre>
<p>然后就可以获取信息，并显示到网页上。获取信息通过 fetch，这是一个新标准的前端与后端通信的 JS 函数。</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-javascript"><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">function</span><span style="color:#59873A;--shiki-dark:#80A665"> getTodoList</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">  fetch</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">http://...</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    .</span><span style="color:#59873A;--shiki-dark:#80A665">then</span><span style="color:#999999;--shiki-dark:#666666">((</span><span style="color:#B07D48;--shiki-dark:#BD976A">response</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#B07D48;--shiki-dark:#BD976A"> response</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">json</span><span style="color:#999999;--shiki-dark:#666666">())</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    .</span><span style="color:#59873A;--shiki-dark:#80A665">then</span><span style="color:#999999;--shiki-dark:#666666">((</span><span style="color:#B07D48;--shiki-dark:#BD976A">data</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> =></span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">      const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> ul</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> document</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">getElementById</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">todo-list</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">      for</span><span style="color:#999999;--shiki-dark:#666666"> (</span><span style="color:#AB5959;--shiki-dark:#CB7676">let</span><span style="color:#B07D48;--shiki-dark:#BD976A"> i</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 0</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#B07D48;--shiki-dark:#BD976A"> i</span><span style="color:#999999;--shiki-dark:#666666"> &#x3C;</span><span style="color:#B07D48;--shiki-dark:#BD976A"> data</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#998418;--shiki-dark:#B8A965">length</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#B07D48;--shiki-dark:#BD976A"> i</span><span style="color:#AB5959;--shiki-dark:#CB7676">++</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">        //主体备忘内容</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">        const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> li</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> document</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">createElement</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">li</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">        const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> iDel</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> document</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">createElement</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">i</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">        iDel</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">className</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">fad fa-check</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">        iDel</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">onclick</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666"> ()</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">          //按钮绑定删除备忘事件</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">          fetch</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#B56959;--shiki-dark:#C98A7D">http://.../del.php/?i=</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#B56959;--shiki-dark:#C98A7D">i</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">          ul</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">innerHTML</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> ""</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">          setTimeout</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">getTodoList()</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 100</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">        };</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">        li</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">innerHTML</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> data</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">events</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#999999;--shiki-dark:#666666">].</span><span style="color:#B07D48;--shiki-dark:#BD976A">content</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">        li</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">appendChild</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">iDel</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">        ul</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">appendChild</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">li</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">      const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> input</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> document</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">createElement</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">input</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">      input</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">setAttribute</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">type</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">text</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">      ul</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">appendChild</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">input</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">      const</span><span style="color:#B07D48;--shiki-dark:#BD976A"> upload</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B07D48;--shiki-dark:#BD976A"> document</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">createElement</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">i</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> //上传确认按键</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">      upload</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">className</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">fad fa-play</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">      upload</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">onclick</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> function</span><span style="color:#999999;--shiki-dark:#666666"> ()</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">        fetch</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#B56959;--shiki-dark:#C98A7D">http://.../add.php/?content=</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#59873A;--shiki-dark:#80A665">encodeURIComponent</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B56959;--shiki-dark:#C98A7D">input</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B56959;--shiki-dark:#C98A7D">value</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">        ul</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">innerHTML</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> ""</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">        setTimeout</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">getTodoList()</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 100</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">      };</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">      ul</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#59873A;--shiki-dark:#80A665">appendChild</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">upload</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    })</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    .</span><span style="color:#59873A;--shiki-dark:#80A665">catch</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B07D48;--shiki-dark:#BD976A">console</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#B07D48;--shiki-dark:#BD976A">error</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">getTodoList</span><span style="color:#999999;--shiki-dark:#666666">();</span></span></code></pre>
<p>这个时候前端界面就完成了。这里用到了三个接口，一个是获取信息，一个是删除备忘，一个是增加备忘。</p>
<p>分别对应的是同一个目录下的 <code>index.php, del.php, add.php</code>。</p>
<h2 id="%E5%90%8E%E7%AB%AF-php-%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%AE%9E%E7%8E%B0" tabindex="-1">后端 php 接口的实现</h2>
<p>这里代码本人随便写的，指导思想能 work 就行（</p>
<p>在 <code>index.php, del.php, add.php</code> 的目录下，存储文件 <code>memo.txt</code> 用于存储 JSON 字符串。</p>
<p>随后就是一堆文件读写和字符串处理：</p>
<p><code>index.php</code> ：</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-php"><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">&#x3C;?</span><span style="color:#A65E2B;--shiki-dark:#C99076">php</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">header</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Origin: *</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> fopen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">r</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5959;--shiki-dark:#CB7676"> or</span><span style="color:#1E754F;--shiki-dark:#4D9375"> die</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Unable to open file!</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">echo</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">{</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#998418;--shiki-dark:#B8A965"> fread</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#998418;--shiki-dark:#B8A965">filesize</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">))</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fclose</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">?></span></span></code></pre>
<p>直接发送文件内容。</p>
<p><code>add.php</code> ：</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-php"><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">&#x3C;?</span><span style="color:#A65E2B;--shiki-dark:#C99076">php</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">header</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Origin: *</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">content</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> $</span><span style="color:#B07D48;--shiki-dark:#BD976A">_GET</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">content</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">];</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">content</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> urldecode</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">content</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> ""</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">0</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> fopen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">r</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5959;--shiki-dark:#CB7676"> or</span><span style="color:#1E754F;--shiki-dark:#4D9375"> die</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Unable to open file!</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">//通过统计行数获取当前数量</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">while</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676">!</span><span style="color:#998418;--shiki-dark:#B8A965">feof</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">)){</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">    fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676">++</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#999999;--shiki-dark:#666666">-=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">   //增加后数量</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fclose</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> fopen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">r</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5959;--shiki-dark:#CB7676"> or</span><span style="color:#1E754F;--shiki-dark:#4D9375"> die</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Unable to open file!</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// 接下来需要字符串拼接</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">"length":</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#999999;--shiki-dark:#666666"> $</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">"events": [</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">for</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">0</span><span style="color:#999999;--shiki-dark:#666666">;$</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676">-</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">;$</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#AB5959;--shiki-dark:#CB7676">++</span><span style="color:#999999;--shiki-dark:#666666">){</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">   // 前面的拼接</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#998418;--shiki-dark:#B8A965"> fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">if</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676">!=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">){</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">	//如果数量不为 0，前一行最后要补逗号</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#998418;--shiki-dark:#B8A965">chop</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">{"content":"</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#999999;--shiki-dark:#666666"> $</span><span style="color:#B07D48;--shiki-dark:#BD976A">content</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">"}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">]</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fclose</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">//接下来写入文件</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">filewrite</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> fopen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">w</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5959;--shiki-dark:#CB7676"> or</span><span style="color:#1E754F;--shiki-dark:#4D9375"> die</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Unable to open file!</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fwrite</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">filewrite</span><span style="color:#999999;--shiki-dark:#666666">,$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fclose</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">filewrite</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">?></span></span></code></pre>
<p>将新的备忘内容追加到最后一行。</p>
<p><code>del.php</code> ：</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-php"><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">&#x3C;?</span><span style="color:#A65E2B;--shiki-dark:#C99076">php</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">header</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Access-Control-Allow-Origin: *</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">index</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#999999;--shiki-dark:#666666"> $</span><span style="color:#B07D48;--shiki-dark:#BD976A">_GET</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">i</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">];</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> ""</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">0</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> fopen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">r</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5959;--shiki-dark:#CB7676"> or</span><span style="color:#1E754F;--shiki-dark:#4D9375"> die</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Unable to open file!</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">//现在已经在文件头，考虑定位到第 i 项并删除</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">//通过统计行数获取当前数量</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">while</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676">!</span><span style="color:#998418;--shiki-dark:#B8A965">feof</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">)){</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">    fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676">++</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#999999;--shiki-dark:#666666">-=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">4</span><span style="color:#999999;--shiki-dark:#666666">;</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">   //即为删除后数量</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fclose</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">myfile</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> fopen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">r</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5959;--shiki-dark:#CB7676"> or</span><span style="color:#1E754F;--shiki-dark:#4D9375"> die</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Unable to open file!</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// 接下来需要字符串拼接</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">"length":</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#999999;--shiki-dark:#666666"> $</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">"events": [</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">for</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">0</span><span style="color:#999999;--shiki-dark:#666666">;$</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">index</span><span style="color:#999999;--shiki-dark:#666666">;$</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#AB5959;--shiki-dark:#CB7676">++</span><span style="color:#999999;--shiki-dark:#666666">){</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#998418;--shiki-dark:#B8A965"> fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">	//要删除的行，读取一遍跳过拼接即可</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">for</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#2F798A;--shiki-dark:#4C9A91">0</span><span style="color:#999999;--shiki-dark:#666666">;$</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#AB5959;--shiki-dark:#CB7676">&#x3C;</span><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676">-</span><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">index</span><span style="color:#999999;--shiki-dark:#666666">;$</span><span style="color:#B07D48;--shiki-dark:#BD976A">i</span><span style="color:#AB5959;--shiki-dark:#CB7676">++</span><span style="color:#999999;--shiki-dark:#666666">){</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">   // 还剩余多少条</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#998418;--shiki-dark:#B8A965"> fgets</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">if</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">count</span><span style="color:#AB5959;--shiki-dark:#CB7676">==</span><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">index</span><span style="color:#999999;--shiki-dark:#666666">){</span><span style="color:#A0ADA0;--shiki-dark:#758575DD">	//如果删除的是最后一条，前面的逗号需要去除</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#998418;--shiki-dark:#B8A965">chop</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#A65E2B;--shiki-dark:#C99076"> PHP_EOL</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">]</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#1E754F;--shiki-dark:#4D9375"> else</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    $</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">=$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#AB5959;--shiki-dark:#CB7676"> .</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">  '</span><span style="color:#B56959;--shiki-dark:#C98A7D">]</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fclose</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">file</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">//接下来写入文件</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">$</span><span style="color:#B07D48;--shiki-dark:#BD976A">filewrite</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#998418;--shiki-dark:#B8A965"> fopen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">memo.txt</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">w</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5959;--shiki-dark:#CB7676"> or</span><span style="color:#1E754F;--shiki-dark:#4D9375"> die</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Unable to open file!</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fwrite</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">filewrite</span><span style="color:#999999;--shiki-dark:#666666">,$</span><span style="color:#B07D48;--shiki-dark:#BD976A">str</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">fclose</span><span style="color:#999999;--shiki-dark:#666666">($</span><span style="color:#B07D48;--shiki-dark:#BD976A">filewrite</span><span style="color:#999999;--shiki-dark:#666666">);</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">?></span></span></code></pre>
<p>能用就行（</p>
<h2 id="%E8%B7%A8%E5%9F%9F%E9%80%9A%E4%BF%A1" tabindex="-1">跨域通信</h2>
<p>可能有人以及注意到了我上面 php 文件里的 <code>header(&quot;Access-Control-Allow-Origin: *&quot;);</code></p>
<p>* 可换成指定域名，指定特定的 Origin 才可以跨域请求本 php 文件。</p>
<p>这里涉及到跨域的概念，感兴趣的可以自己百度（</p>

    </main>
    <script type="text/javascript">
      var main = document.querySelector('main');
      var content = main.innerHTML;
      sessionStorage.setItem('first-php', content);
      sessionStorage.setItem('first-php__time', Date.now().toString());
      
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      var pathSegmentsToKeep = 0;

      var l = window.location;
      l.replace(
        l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') +
        l.pathname.split('/').slice(0, 1 + pathSegmentsToKeep).join('/') + '/?/' +
        l.pathname.slice(1).split('/').slice(pathSegmentsToKeep).join('/').replace(/&/g, '~and~') +
        (l.search ? '&' + l.search.slice(1).replace(/&/g, '~and~') : '') +
        l.hash
      );
    </script>
  </body>
</html>