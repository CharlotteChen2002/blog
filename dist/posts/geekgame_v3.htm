<p>发现自己很久没更过博客了，也确实有点不知道该写什么，于是来水一篇最近的第三届北京大学信息安全综合能力竞赛（PKU GeekGame）部分题解了。<s>工作摸鱼</s>打了一周，最后总排名 15。</p>
<!-- more -->
<p>碎碎念：感觉 GeekGame 的 Web 题质量好高，做爽了。</p>
<p>本题解不含图片，可放心食用。</p>
<h2 id="%E4%B8%80%E7%9C%BC%E7%9B%AF%E5%B8%A7" tabindex="-1">一眼盯帧</h2>
<p>签到题。提取 GIF 的每一帧有很多方法，比如直接谷歌，找一个在线工具网站就好了。然后 rot13。</p>
<h2 id="%E5%B0%8F%E5%8C%97%E9%97%AE%E7%AD%94!!!!!" tabindex="-1">小北问答!!!!!</h2>
<p><s>It's MyGO!!!!!</s></p>
<blockquote>
<p>在北京大学（校级）高性能计算平台中，什么命令可以提交一个非交互式任务？</p>
</blockquote>
<p>谷歌关键词：北京大学（校级）高性能计算平台、非交互式任务，得 sbatch。</p>
<blockquote>
<p>根据 GPL 许可证的要求，基于 Linux 二次开发的操作系统内核必须开源。例如小米公司开源了 Redmi K60 Ultra 手机的内核。其内核版本号是？</p>
</blockquote>
<p>谷歌得小米内核开源项目的 GitHub 地址，README 中指出了 Redmi K60 Ultra 对应的分支 corot-t-oss，所以可以找到 <a href="https://github.com/MiCode/Xiaomi_Kernel_OpenSource/blob/corot-t-oss/Makefile" target="_blank" rel="noopener">构建的 Makefile 文件</a>。</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-makefile"><span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># SPDX-License-Identifier: GPL-2.0</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">VERSION</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> 5</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">PATCHLEVEL</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> 15</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">SUBLEVEL</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> 78</span></span></code></pre>
<p>所以答案是 5.15.78。</p>
<blockquote>
<p>每款苹果产品都有一个内部的识别名称（Identifier），例如初代 iPhone 是 iPhone1,1。那么 Apple Watch Series 8（蜂窝版本，41mm 尺寸）是什么？</p>
</blockquote>
<p>搜索：Identifier、iPhone1,1 就能找到完整对照表。</p>
<blockquote>
<p>本届 PKU GeekGame 的比赛平台会禁止选手昵称中包含某些特殊字符。截止到 2023 年 10 月 1 日，共禁止了多少个字符？（提示：本题答案与 Python 版本有关，以平台实际运行情况为准）</p>
</blockquote>
<p>找到源码，加一条 print 语句，python 跑一下就可以了。</p>
<blockquote>
<p>在 2011 年 1 月，Bilibili 游戏区下共有哪些子分区？（按网站显示顺序，以半角逗号分隔）</p>
</blockquote>
<p>众所周知 Bilibili 现用域名 <a href="https://www.bilibili.com/" target="_blank" rel="noopener">https://www.bilibili.com/</a>，但是直接在 WebArchive 上是找不到对应历史的，搜索后得知 2011 年 1 月 Bilibili 域名 <a href="https://bilibili.us/" target="_blank" rel="noopener">https://bilibili.us/</a>，用这个在 WebArchive 上查就可以了。</p>
<blockquote>
<p>这个照片中出现了一个大型建筑物，它的官方网站的域名是什么？（照片中部分信息已被有意遮挡，请注意检查答案格式）</p>
</blockquote>
<p>简单来说图片里有一些赞助商信息，搜索得知这是 2023 年的 IASP 会议，举办地点在卢森堡的 European Convention Centre Luxembourg，但是建筑图片和照片对不上，所以谷歌地图查看周围建筑，发现符合条件的建筑是卢森堡音乐厅，所以答案是 philharmonie.lu。</p>
<h2 id="z-%E5%85%AC%E5%8F%B8%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8" tabindex="-1">Z 公司的服务器</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE" tabindex="-1">第一问</h3>
<p>直接打开终端显示 <code>�*B00000000000000</code>，搜索发现应该是 Z Modem 协议，用支持的客户端 ZOC Terminal 连接即可接收文件。</p>
<h2 id="%E7%8C%AB%E5%92%AA%E7%8A%B6%E6%80%81%E7%9B%91%E8%A7%86%E5%99%A8" tabindex="-1">猫咪状态监视器</h2>
<p>阅读 <code>/usr/sbin/service</code> 源码，发现没有 systemd 的环境下逻辑是这样的：</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-shell"><span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">SERVICEDIR</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">/etc/init.d</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">run_via_sysvinit</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">   # Otherwise, use the traditional sysvinit</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">   if</span><span style="color:#999999;--shiki-dark:#666666"> [</span><span style="color:#AB5959;--shiki-dark:#CB7676"> -x</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#999999;--shiki-dark:#666666">${</span><span style="color:#B56959;--shiki-dark:#C98A7D">SERVICEDIR</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">/</span><span style="color:#999999;--shiki-dark:#666666">${</span><span style="color:#B56959;--shiki-dark:#C98A7D">SERVICE</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> ];</span><span style="color:#1E754F;--shiki-dark:#4D9375"> then</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">      exec</span><span style="color:#B56959;--shiki-dark:#C98A7D"> env</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -i</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LANG=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LANG</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LANGUAGE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LANGUAGE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_CTYPE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_CTYPE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_NUMERIC=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_NUMERIC</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_TIME=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_TIME</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_COLLATE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_COLLATE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_MONETARY=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_MONETARY</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_MESSAGES=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_MESSAGES</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_PAPER=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_PAPER</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_NAME=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_NAME</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_ADDRESS=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_ADDRESS</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_TELEPHONE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_TELEPHONE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_MEASUREMENT=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_MEASUREMENT</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_IDENTIFICATION=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_IDENTIFICATION</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_ALL=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_ALL</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> PATH=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$PATH</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> TERM=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$TERM</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">$SERVICEDIR/$SERVICE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> ${</span><span style="color:#B07D48;--shiki-dark:#BD976A">ACTION</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#999999;--shiki-dark:#666666"> ${</span><span style="color:#B07D48;--shiki-dark:#BD976A">OPTIONS</span><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">   else</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">      echo</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#999999;--shiki-dark:#666666">${</span><span style="color:#B56959;--shiki-dark:#C98A7D">SERVICE</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">: unrecognized service</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> >&#x26;2</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">      exit</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">   fi</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span></code></pre>
<p>所以 payload 是 <code>../../../../usr/bin/cat flag.txt</code>。</p>
<h2 id="%E5%9F%BA%E6%9C%AC%E5%8A%9F" tabindex="-1">基本功</h2>
<p>ZIP 经典的已知（部分）明文攻击。bkcrack 破解一下就好了。</p>
<h2 id="dark-room" tabindex="-1">Dark Room</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-1" tabindex="-1">第一问</h3>
<p>要求以高于指定 sanity 通关。提示是 roll help 来获取足够的 sanity，但这里有个非预期解，用过钥匙打开的有门的房间可以继续用钥匙打开刷 sanity（因为使用钥匙时只判断了房间有没有门），所以刷一会就可以了。</p>
<h3 id="%E7%AC%AC%E4%BA%8C%E9%97%AE" tabindex="-1">第二问</h3>
<p>通过报错泄露了一部分源代码：</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-python"><span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">Traceback </span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">most recent call last</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    File </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">dark_room/player.py</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line </span><span style="color:#2F798A;--shiki-dark:#4C9A91">249</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#AB5959;--shiki-dark:#CB7676"> in</span><span style="color:#AB5959;--shiki-dark:#CB7676"> &#x3C;</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">module</span><span style="color:#AB5959;--shiki-dark:#CB7676">></span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    248</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#1E754F;--shiki-dark:#4D9375">   while</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> flag_number</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    249</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">      choice </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#998418;--shiki-dark:#B8A965"> int</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">self</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">recv</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676">b</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Guess my public key (give me a number): </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">).</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">decode</span><span style="color:#999999;--shiki-dark:#666666">())</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    250</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#1E754F;--shiki-dark:#4D9375">      if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> flag_number </span><span style="color:#AB5959;--shiki-dark:#CB7676">&#x26;</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    251</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">          p </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> getStrongPrime</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2048</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    252</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">          q </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> getStrongPrime</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2048</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    253</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">      flag_number </span><span style="color:#999999;--shiki-dark:#666666">>>=</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span></span></code></pre>
<p>可以看到会遍历 <code>flag_number</code> 的每一位，如果是 1 就生成两个 2048 位的大素数。生成大素数是很消耗时间的，也会明显感觉到终端的卡顿，所以可以用这个特性来判断 <code>flag_number</code> 的每一位是 0 还是 1，然后拼接起来就是 flag 了。属于侧信道攻击的范畴。</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-python"><span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> subprocess </span><span style="color:#1E754F;--shiki-dark:#4D9375">as</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> sp</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">from</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time </span><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> sleep</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">CMD</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">nc prob16.geekgame.pku.edu.cn 10016</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">split</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">TOKEN</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">...</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">Popen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">CMD</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> stdin</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#A65E2B;--shiki-dark:#C99076">PIPE</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> stdout</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#A65E2B;--shiki-dark:#C99076">PIPE</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> stderr</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#A65E2B;--shiki-dark:#C99076">PIPE</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">def</span><span style="color:#59873A;--shiki-dark:#80A665"> p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">s</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#998418;--shiki-dark:#B8A965"> str</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> endstr</span><span style="color:#AB5959;--shiki-dark:#CB7676">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#A65E2B;--shiki-dark:#C99076">\n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    p</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">stdin</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">write</span><span style="color:#999999;--shiki-dark:#666666">((</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">s </span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#A65E2B;--shiki-dark:#C99076">\n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">).</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">encode</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">utf-8</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">))</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    p</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">stdin</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">flush</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">    while</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line </span><span style="color:#999999;--shiki-dark:#666666">:=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> p</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">stdout</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">readline</span><span style="color:#999999;--shiki-dark:#666666">():</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">        line </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">decode</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">        print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">debug:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> end</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">""</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> endstr </span><span style="color:#AB5959;--shiki-dark:#CB7676">in</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">            print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">line</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> end</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">""</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">            break</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">TOKEN</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">to quit the application</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">newgame</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">What</span><span style="color:#A65E2B;--shiki-dark:#C99076">\'</span><span style="color:#B56959;--shiki-dark:#C98A7D">s your name?</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">y</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sleep</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">y</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">w</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">w</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">s</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">getflag</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">========================================================================</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># 接下来需要循环计时，直到退出</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time_list </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> []</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">while</span><span style="color:#1E754F;--shiki-dark:#4D9375"> True</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    start </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">0</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Wrong</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    end </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    time_list</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">append</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">end </span><span style="color:#AB5959;--shiki-dark:#CB7676">-</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> start</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">    print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time_list</span><span style="color:#999999;--shiki-dark:#666666">)</span></span></code></pre>
<p>跑到报错收集一下 <code>time_list</code>，然后用 0.5 秒作为阈值，大于阈值就是 1，小于阈值就是 0，拼接起来十六进制就是 flag 的 ASCII 码了。</p>
<h2 id="%E9%BA%A6%E6%81%A9%C2%B7%E5%BA%93%E6%8B%89%E5%A4%AB%E7%89%B9" tabindex="-1">麦恩·库拉夫特</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-2" tabindex="-1">第一问</h3>
<p>出生点附近告示牌。</p>
<h3 id="%E7%AC%AC%E4%BA%8C%E9%97%AE-1" tabindex="-1">第二问</h3>
<p>查看地图存档发现文件名是 <code>r.0.0.mca</code> 的格式，<code>r.6.-4.mca</code> 与别的数字不连续且文件大小较大，可以猜测有 flag。搜索发现这里一个单位是 512 个方块，我用 Amulet 导出了一下存档找了下告示牌，即为 flag。</p>
<h2 id="emoji-wordle" tabindex="-1">Emoji Wordle</h2>
<p>利用了 Play framework 是无状态的，所以每个 cookie 作为一个状态都可以被 fork 出无数份，也就没有了尝试数量的限制。</p>
<p>第三问的脚本可以覆盖前两问，所以直接用第三问的脚本就可以了。</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-python"><span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> requests</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> urllib</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">parse</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">cookie </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">    "</span><span style="color:#B56959;--shiki-dark:#C98A7D">PLAY_SESSION</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">......</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> # 手动去浏览器复制一下就好</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> [</span><span style="color:#998418;--shiki-dark:#B8A965">chr</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#1E754F;--shiki-dark:#4D9375"> for</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> i </span><span style="color:#1E754F;--shiki-dark:#4D9375">in</span><span style="color:#998418;--shiki-dark:#B8A965"> range</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">128016</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 128144</span><span style="color:#999999;--shiki-dark:#666666">)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">def</span><span style="color:#59873A;--shiki-dark:#80A665"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">emojis</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#998418;--shiki-dark:#B8A965"> str</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    emojis </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> urllib</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">parse</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">quote_plus</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">emojis</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    url </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> (</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">        f</span><span style="color:#B56959;--shiki-dark:#C98A7D">'https://prob14.geekgame.pku.edu.cn/level3?guess=</span><span style="color:#A65E2B;--shiki-dark:#C99076">{</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">emojis</span><span style="color:#A65E2B;--shiki-dark:#C99076">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">'</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    )</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    res </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> requests</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">get</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">url</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> cookies</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">cookie</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    text </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> res</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">text</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">    return</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> re</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">findall</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676">r</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5E3F;--shiki-dark:#C4704F">push</span><span style="color:#BDA437;--shiki-dark:#E6CC77">\(</span><span style="color:#AB5E3F;--shiki-dark:#C4704F">"</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#998418;--shiki-dark:#B8A965">.</span><span style="color:#2F798A;--shiki-dark:#4C9A91">+</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5E3F;--shiki-dark:#C4704F">"</span><span style="color:#BDA437;--shiki-dark:#E6CC77">\)</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> text</span><span style="color:#999999;--shiki-dark:#666666">)[</span><span style="color:#2F798A;--shiki-dark:#4C9A91">0</span><span style="color:#999999;--shiki-dark:#666666">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">res </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">0</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet_used </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">''</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">join</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">[:</span><span style="color:#2F798A;--shiki-dark:#4C9A91">64</span><span style="color:#999999;--shiki-dark:#666666">]))</span><span style="color:#AB5959;--shiki-dark:#CB7676"> +</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">''</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">join</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#2F798A;--shiki-dark:#4C9A91">64</span><span style="color:#999999;--shiki-dark:#666666">:]))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">for</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> i </span><span style="color:#1E754F;--shiki-dark:#4D9375">in</span><span style="color:#998418;--shiki-dark:#B8A965"> range</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#998418;--shiki-dark:#B8A965">len</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">)):</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> alphabet_used</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">🟥</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">        # find out its all occurences</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">        occurences </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 64</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">        for</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> j </span><span style="color:#1E754F;--shiki-dark:#4D9375">in</span><span style="color:#998418;--shiki-dark:#B8A965"> range</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">64</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">            if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> occurences</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">j</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ==</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">🟩</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">                res </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> res</span><span style="color:#999999;--shiki-dark:#666666">[:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">j</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> +</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> alphabet</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> +</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> res</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">j</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">:]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">res</span><span style="color:#999999;--shiki-dark:#666666">)</span></span></code></pre>
<p><code>alphabet</code> 字母表是多开几次游戏，把每次出现的字符加入某个 <code>set</code> 就能得到了。</p>
<h2 id="%E7%AC%AC%E4%B8%89%E6%96%B0-xss" tabindex="-1">第三新 XSS</h2>
<p>这题第二阶段提示给的实在是太多了。。。</p>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-3" tabindex="-1">第一问</h3>
<blockquote>
<p>给 Cookie 设置 Path 并不能带来安全性。<a href="https://developer.mozilla.org/en-US/docs/web/api/document/cookie#security" target="_blank" rel="noopener">MDN 文档</a> 专门有一节来指出其中的问题。</p>
</blockquote>
<p>所以开个 <code>&lt;iframe&gt;</code> 就好。</p>
<h3 id="%E7%AC%AC%E4%BA%8C%E9%97%AE-2" tabindex="-1">第二问</h3>
<blockquote>
<p>你需要 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers" target="_blank" rel="noopener">注册一个 Service Worker</a>，而且要注册到 &quot;/&quot; 这个 scope 上。</p>
</blockquote>
<p>所以注册一下 Service Worker，然后在 Service Worker 里面拦截对 &quot;/admin&quot; 的请求即可。会遇到一些响应头的小问题，看报错提示修复就好了。</p>
<h2 id="%E7%AE%80%E5%8D%95%E7%9A%84%E6%89%93%E5%AD%97%E7%A8%BF" tabindex="-1">简单的打字稿</h2>
<p>需要提取 TypeScript 类型中的 flag。</p>
<p>由于编译到 JavaScript 后，所有的类型都会被擦除，所以需要在编译时用报错提取。</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-typescript"><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> flag1</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">flag{...}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> flag2</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> object</span><span style="color:#999999;--shiki-dark:#666666"> |</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#999999;--shiki-dark:#666666">():</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#59873A;--shiki-dark:#80A665"> v</span><span style="color:#999999;--shiki-dark:#666666">: () => (</span><span style="color:#59873A;--shiki-dark:#80A665">a</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">a</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">b</span><span style="color:#999999;--shiki-dark:#666666">: { </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">flag{...}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">never</span><span style="color:#999999;--shiki-dark:#666666"> } &#x26; </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">>) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">never</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666"> }</span><span style="color:#999999;--shiki-dark:#666666"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractStringFlag</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">T</span><span style="color:#999999;--shiki-dark:#666666">></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> T</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> `</span><span style="color:#B56959;--shiki-dark:#C98A7D">flag</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type1</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractStringFlag</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">flag1</span><span style="color:#999999;--shiki-dark:#666666">>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractObject</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">T</span><span style="color:#999999;--shiki-dark:#666666">></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> T</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#999999;--shiki-dark:#666666">():</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#59873A;--shiki-dark:#80A665"> v</span><span style="color:#999999;--shiki-dark:#666666">: () => (</span><span style="color:#59873A;--shiki-dark:#80A665">a</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">a</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">b</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#999999;--shiki-dark:#666666"> &#x26; </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">>) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">never</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666"> }</span><span style="color:#999999;--shiki-dark:#666666"> }</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type2</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractStringFlag</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#AB5959;--shiki-dark:#CB7676">keyof</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractObject</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">flag2</span><span style="color:#999999;--shiki-dark:#666666">>>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// flag2 类似 flag{...flag...} 格式</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// 因此 type2 是 {...flag...} 格式</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// 题目限制了输出不能有 flag，所以处理一下</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type2</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> `</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">f</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type2</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> `</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">f</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// 以下触发报错，输出不能太长，所以每次选一个就好</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let </span><span style="color:#B07D48;--shiki-dark:#BD976A">a</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">type1</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let </span><span style="color:#B07D48;--shiki-dark:#BD976A">b</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">L</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let </span><span style="color:#B07D48;--shiki-dark:#BD976A">c</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">R</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">;</span></span></code></pre>
<h2 id="%E9%80%9D%E7%95%8C%E8%AE%A1%E5%88%92" tabindex="-1">逝界计划</h2>
<p>利用 <a href="https://www.home-assistant.io/" target="_blank" rel="noopener">Home Assistant</a> 的漏洞读取远程磁盘上的 <code>/flag.txt</code>。</p>
<p>提示限定了 nmap 集成后就很简单了。添加 nmap 集成，发现可以自定义它的参数，输入设置成 <code>/flag.txt</code>，输出设置成 Home Assistant 的日志文件，然后等待 nmap 运行，就能在日志文件中看到 flag 了。</p>
<h2 id="%E9%9D%9E%E6%B3%95%E6%89%80%E5%BE%97" tabindex="-1">非法所得</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-4" tabindex="-1">第一问</h3>
<p>自定义 clash 配置文件的 proxy-providers 导入本地的 <code>/app/profiles/flag.yml</code> 就好。</p>
<h2 id="%E6%B1%89%E5%8C%96%E7%BB%BF%E8%89%B2%E7%89%88%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD" tabindex="-1">汉化绿色版免费下载</h2>
<p>kirikiri 解包。需要注意有个文件记录了所有选项的选择次数。</p>
<p>后面题目是 binary 和 algo，几乎没有完整做出来，就不写了。</p>
