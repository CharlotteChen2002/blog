<p>å‘ç°è‡ªå·±å¾ˆä¹…æ²¡æ›´è¿‡åšå®¢äº†ï¼Œä¹Ÿç¡®å®æœ‰ç‚¹ä¸çŸ¥é“è¯¥å†™ä»€ä¹ˆï¼Œäºæ˜¯æ¥æ°´ä¸€ç¯‡æœ€è¿‘çš„ç¬¬ä¸‰å±ŠåŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›ï¼ˆPKU GeekGameï¼‰éƒ¨åˆ†é¢˜è§£äº†ã€‚<s>å·¥ä½œæ‘¸é±¼</s>æ‰“äº†ä¸€å‘¨ï¼Œæœ€åæ€»æ’å 15ã€‚</p>
<!-- more -->
<p>ç¢ç¢å¿µï¼šæ„Ÿè§‰ GeekGame çš„ Web é¢˜è´¨é‡å¥½é«˜ï¼Œåšçˆ½äº†ã€‚</p>
<p>æœ¬é¢˜è§£ä¸å«å›¾ç‰‡ï¼Œå¯æ”¾å¿ƒé£Ÿç”¨ã€‚</p>
<h2 id="%E4%B8%80%E7%9C%BC%E7%9B%AF%E5%B8%A7" tabindex="-1">ä¸€çœ¼ç›¯å¸§</h2>
<p>ç­¾åˆ°é¢˜ã€‚æå– GIF çš„æ¯ä¸€å¸§æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚ç›´æ¥è°·æ­Œï¼Œæ‰¾ä¸€ä¸ªåœ¨çº¿å·¥å…·ç½‘ç«™å°±å¥½äº†ã€‚ç„¶å rot13ã€‚</p>
<h2 id="%E5%B0%8F%E5%8C%97%E9%97%AE%E7%AD%94!!!!!" tabindex="-1">å°åŒ—é—®ç­”!!!!!</h2>
<p><s>It's MyGO!!!!!</s></p>
<blockquote>
<p>åœ¨åŒ—äº¬å¤§å­¦ï¼ˆæ ¡çº§ï¼‰é«˜æ€§èƒ½è®¡ç®—å¹³å°ä¸­ï¼Œä»€ä¹ˆå‘½ä»¤å¯ä»¥æäº¤ä¸€ä¸ªéäº¤äº’å¼ä»»åŠ¡ï¼Ÿ</p>
</blockquote>
<p>è°·æ­Œå…³é”®è¯ï¼šåŒ—äº¬å¤§å­¦ï¼ˆæ ¡çº§ï¼‰é«˜æ€§èƒ½è®¡ç®—å¹³å°ã€éäº¤äº’å¼ä»»åŠ¡ï¼Œå¾— sbatchã€‚</p>
<blockquote>
<p>æ ¹æ® GPL è®¸å¯è¯çš„è¦æ±‚ï¼ŒåŸºäº Linux äºŒæ¬¡å¼€å‘çš„æ“ä½œç³»ç»Ÿå†…æ ¸å¿…é¡»å¼€æºã€‚ä¾‹å¦‚å°ç±³å…¬å¸å¼€æºäº† Redmi K60 Ultra æ‰‹æœºçš„å†…æ ¸ã€‚å…¶å†…æ ¸ç‰ˆæœ¬å·æ˜¯ï¼Ÿ</p>
</blockquote>
<p>è°·æ­Œå¾—å°ç±³å†…æ ¸å¼€æºé¡¹ç›®çš„ GitHub åœ°å€ï¼ŒREADME ä¸­æŒ‡å‡ºäº† Redmi K60 Ultra å¯¹åº”çš„åˆ†æ”¯ corot-t-ossï¼Œæ‰€ä»¥å¯ä»¥æ‰¾åˆ° <a href="https://github.com/MiCode/Xiaomi_Kernel_OpenSource/blob/corot-t-oss/Makefile" target="_blank" rel="noopener">æ„å»ºçš„ Makefile æ–‡ä»¶</a>ã€‚</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-makefile"><span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># SPDX-License-Identifier: GPL-2.0</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">VERSION</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> 5</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">PATCHLEVEL</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> 15</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">SUBLEVEL</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> 78</span></span></code></pre>
<p>æ‰€ä»¥ç­”æ¡ˆæ˜¯ 5.15.78ã€‚</p>
<blockquote>
<p>æ¯æ¬¾è‹¹æœäº§å“éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„è¯†åˆ«åç§°ï¼ˆIdentifierï¼‰ï¼Œä¾‹å¦‚åˆä»£ iPhone æ˜¯ iPhone1,1ã€‚é‚£ä¹ˆ Apple Watch Series 8ï¼ˆèœ‚çªç‰ˆæœ¬ï¼Œ41mm å°ºå¯¸ï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</blockquote>
<p>æœç´¢ï¼šIdentifierã€iPhone1,1 å°±èƒ½æ‰¾åˆ°å®Œæ•´å¯¹ç…§è¡¨ã€‚</p>
<blockquote>
<p>æœ¬å±Š PKU GeekGame çš„æ¯”èµ›å¹³å°ä¼šç¦æ­¢é€‰æ‰‹æ˜µç§°ä¸­åŒ…å«æŸäº›ç‰¹æ®Šå­—ç¬¦ã€‚æˆªæ­¢åˆ° 2023 å¹´ 10 æœˆ 1 æ—¥ï¼Œå…±ç¦æ­¢äº†å¤šå°‘ä¸ªå­—ç¬¦ï¼Ÿï¼ˆæç¤ºï¼šæœ¬é¢˜ç­”æ¡ˆä¸ Python ç‰ˆæœ¬æœ‰å…³ï¼Œä»¥å¹³å°å®é™…è¿è¡Œæƒ…å†µä¸ºå‡†ï¼‰</p>
</blockquote>
<p>æ‰¾åˆ°æºç ï¼ŒåŠ ä¸€æ¡ print è¯­å¥ï¼Œpython è·‘ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>
<blockquote>
<p>åœ¨ 2011 å¹´ 1 æœˆï¼ŒBilibili æ¸¸æˆåŒºä¸‹å…±æœ‰å“ªäº›å­åˆ†åŒºï¼Ÿï¼ˆæŒ‰ç½‘ç«™æ˜¾ç¤ºé¡ºåºï¼Œä»¥åŠè§’é€—å·åˆ†éš”ï¼‰</p>
</blockquote>
<p>ä¼—æ‰€å‘¨çŸ¥ Bilibili ç°ç”¨åŸŸå <a href="https://www.bilibili.com/" target="_blank" rel="noopener">https://www.bilibili.com/</a>ï¼Œä½†æ˜¯ç›´æ¥åœ¨ WebArchive ä¸Šæ˜¯æ‰¾ä¸åˆ°å¯¹åº”å†å²çš„ï¼Œæœç´¢åå¾—çŸ¥ 2011 å¹´ 1 æœˆ Bilibili åŸŸå <a href="https://bilibili.us/" target="_blank" rel="noopener">https://bilibili.us/</a>ï¼Œç”¨è¿™ä¸ªåœ¨ WebArchive ä¸ŠæŸ¥å°±å¯ä»¥äº†ã€‚</p>
<blockquote>
<p>è¿™ä¸ªç…§ç‰‡ä¸­å‡ºç°äº†ä¸€ä¸ªå¤§å‹å»ºç­‘ç‰©ï¼Œå®ƒçš„å®˜æ–¹ç½‘ç«™çš„åŸŸåæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç…§ç‰‡ä¸­éƒ¨åˆ†ä¿¡æ¯å·²è¢«æœ‰æ„é®æŒ¡ï¼Œè¯·æ³¨æ„æ£€æŸ¥ç­”æ¡ˆæ ¼å¼ï¼‰</p>
</blockquote>
<p>ç®€å•æ¥è¯´å›¾ç‰‡é‡Œæœ‰ä¸€äº›èµåŠ©å•†ä¿¡æ¯ï¼Œæœç´¢å¾—çŸ¥è¿™æ˜¯ 2023 å¹´çš„ IASP ä¼šè®®ï¼Œä¸¾åŠåœ°ç‚¹åœ¨å¢æ£®å ¡çš„ European Convention Centre Luxembourgï¼Œä½†æ˜¯å»ºç­‘å›¾ç‰‡å’Œç…§ç‰‡å¯¹ä¸ä¸Šï¼Œæ‰€ä»¥è°·æ­Œåœ°å›¾æŸ¥çœ‹å‘¨å›´å»ºç­‘ï¼Œå‘ç°ç¬¦åˆæ¡ä»¶çš„å»ºç­‘æ˜¯å¢æ£®å ¡éŸ³ä¹å…ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯ philharmonie.luã€‚</p>
<h2 id="z-%E5%85%AC%E5%8F%B8%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8" tabindex="-1">Z å…¬å¸çš„æœåŠ¡å™¨</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE" tabindex="-1">ç¬¬ä¸€é—®</h3>
<p>ç›´æ¥æ‰“å¼€ç»ˆç«¯æ˜¾ç¤º <code>ï¿½*B00000000000000</code>ï¼Œæœç´¢å‘ç°åº”è¯¥æ˜¯ Z Modem åè®®ï¼Œç”¨æ”¯æŒçš„å®¢æˆ·ç«¯ ZOC Terminal è¿æ¥å³å¯æ¥æ”¶æ–‡ä»¶ã€‚</p>
<h2 id="%E7%8C%AB%E5%92%AA%E7%8A%B6%E6%80%81%E7%9B%91%E8%A7%86%E5%99%A8" tabindex="-1">çŒ«å’ªçŠ¶æ€ç›‘è§†å™¨</h2>
<p>é˜…è¯» <code>/usr/sbin/service</code> æºç ï¼Œå‘ç°æ²¡æœ‰ systemd çš„ç¯å¢ƒä¸‹é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-shell"><span class="line"><span style="color:#B07D48;--shiki-dark:#BD976A">SERVICEDIR</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">/etc/init.d</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#80A665">run_via_sysvinit</span><span style="color:#999999;--shiki-dark:#666666">()</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">   # Otherwise, use the traditional sysvinit</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">   if</span><span style="color:#999999;--shiki-dark:#666666"> [</span><span style="color:#AB5959;--shiki-dark:#CB7676"> -x</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#999999;--shiki-dark:#666666">${</span><span style="color:#B56959;--shiki-dark:#C98A7D">SERVICEDIR</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">/</span><span style="color:#999999;--shiki-dark:#666666">${</span><span style="color:#B56959;--shiki-dark:#C98A7D">SERVICE</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> ];</span><span style="color:#1E754F;--shiki-dark:#4D9375"> then</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">      exec</span><span style="color:#B56959;--shiki-dark:#C98A7D"> env</span><span style="color:#A65E2B;--shiki-dark:#C99076"> -i</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LANG=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LANG</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LANGUAGE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LANGUAGE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_CTYPE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_CTYPE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_NUMERIC=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_NUMERIC</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_TIME=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_TIME</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_COLLATE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_COLLATE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_MONETARY=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_MONETARY</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_MESSAGES=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_MESSAGES</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_PAPER=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_PAPER</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_NAME=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_NAME</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_ADDRESS=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_ADDRESS</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_TELEPHONE=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_TELEPHONE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_MEASUREMENT=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_MEASUREMENT</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_IDENTIFICATION=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_IDENTIFICATION</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> LC_ALL=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$LC_ALL</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> PATH=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$PATH</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D"> TERM=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">$TERM</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">$SERVICEDIR/$SERVICE</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666"> ${</span><span style="color:#B07D48;--shiki-dark:#BD976A">ACTION</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#999999;--shiki-dark:#666666"> ${</span><span style="color:#B07D48;--shiki-dark:#BD976A">OPTIONS</span><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">   else</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">      echo</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#999999;--shiki-dark:#666666">${</span><span style="color:#B56959;--shiki-dark:#C98A7D">SERVICE</span><span style="color:#999999;--shiki-dark:#666666">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">: unrecognized service</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#AB5959;--shiki-dark:#CB7676"> >&#x26;2</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">      exit</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">   fi</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span></code></pre>
<p>æ‰€ä»¥ payload æ˜¯ <code>../../../../usr/bin/cat flag.txt</code>ã€‚</p>
<h2 id="%E5%9F%BA%E6%9C%AC%E5%8A%9F" tabindex="-1">åŸºæœ¬åŠŸ</h2>
<p>ZIP ç»å…¸çš„å·²çŸ¥ï¼ˆéƒ¨åˆ†ï¼‰æ˜æ–‡æ”»å‡»ã€‚bkcrack ç ´è§£ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<h2 id="dark-room" tabindex="-1">Dark Room</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-1" tabindex="-1">ç¬¬ä¸€é—®</h3>
<p>è¦æ±‚ä»¥é«˜äºæŒ‡å®š sanity é€šå…³ã€‚æç¤ºæ˜¯ roll help æ¥è·å–è¶³å¤Ÿçš„ sanityï¼Œä½†è¿™é‡Œæœ‰ä¸ªéé¢„æœŸè§£ï¼Œç”¨è¿‡é’¥åŒ™æ‰“å¼€çš„æœ‰é—¨çš„æˆ¿é—´å¯ä»¥ç»§ç»­ç”¨é’¥åŒ™æ‰“å¼€åˆ· sanityï¼ˆå› ä¸ºä½¿ç”¨é’¥åŒ™æ—¶åªåˆ¤æ–­äº†æˆ¿é—´æœ‰æ²¡æœ‰é—¨ï¼‰ï¼Œæ‰€ä»¥åˆ·ä¸€ä¼šå°±å¯ä»¥äº†ã€‚</p>
<h3 id="%E7%AC%AC%E4%BA%8C%E9%97%AE" tabindex="-1">ç¬¬äºŒé—®</h3>
<p>é€šè¿‡æŠ¥é”™æ³„éœ²äº†ä¸€éƒ¨åˆ†æºä»£ç ï¼š</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-python"><span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">Traceback </span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">most recent call last</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    File </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">dark_room/player.py</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line </span><span style="color:#2F798A;--shiki-dark:#4C9A91">249</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#AB5959;--shiki-dark:#CB7676"> in</span><span style="color:#AB5959;--shiki-dark:#CB7676"> &#x3C;</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">module</span><span style="color:#AB5959;--shiki-dark:#CB7676">></span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    248</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#1E754F;--shiki-dark:#4D9375">   while</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> flag_number</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    249</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">      choice </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#998418;--shiki-dark:#B8A965"> int</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">self</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">recv</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676">b</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">Guess my public key (give me a number): </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">).</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">decode</span><span style="color:#999999;--shiki-dark:#666666">())</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    250</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#1E754F;--shiki-dark:#4D9375">      if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> flag_number </span><span style="color:#AB5959;--shiki-dark:#CB7676">&#x26;</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    251</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">          p </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> getStrongPrime</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2048</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    252</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">          q </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> getStrongPrime</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2048</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#2F798A;--shiki-dark:#4C9A91">    253</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">      flag_number </span><span style="color:#999999;--shiki-dark:#666666">>>=</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span></span></code></pre>
<p>å¯ä»¥çœ‹åˆ°ä¼šéå† <code>flag_number</code> çš„æ¯ä¸€ä½ï¼Œå¦‚æœæ˜¯ 1 å°±ç”Ÿæˆä¸¤ä¸ª 2048 ä½çš„å¤§ç´ æ•°ã€‚ç”Ÿæˆå¤§ç´ æ•°æ˜¯å¾ˆæ¶ˆè€—æ—¶é—´çš„ï¼Œä¹Ÿä¼šæ˜æ˜¾æ„Ÿè§‰åˆ°ç»ˆç«¯çš„å¡é¡¿ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸ªç‰¹æ€§æ¥åˆ¤æ–­ <code>flag_number</code> çš„æ¯ä¸€ä½æ˜¯ 0 è¿˜æ˜¯ 1ï¼Œç„¶åæ‹¼æ¥èµ·æ¥å°±æ˜¯ flag äº†ã€‚å±äºä¾§ä¿¡é“æ”»å‡»çš„èŒƒç•´ã€‚</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-python"><span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> subprocess </span><span style="color:#1E754F;--shiki-dark:#4D9375">as</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> sp</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">from</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time </span><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> sleep</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">CMD</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">nc prob16.geekgame.pku.edu.cn 10016</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">split</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#A65E2B;--shiki-dark:#C99076">TOKEN</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">...</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">Popen</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">CMD</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> stdin</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#A65E2B;--shiki-dark:#C99076">PIPE</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> stdout</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#A65E2B;--shiki-dark:#C99076">PIPE</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> stderr</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sp</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#A65E2B;--shiki-dark:#C99076">PIPE</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">def</span><span style="color:#59873A;--shiki-dark:#80A665"> p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">s</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#998418;--shiki-dark:#B8A965"> str</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> endstr</span><span style="color:#AB5959;--shiki-dark:#CB7676">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#A65E2B;--shiki-dark:#C99076">\n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    p</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">stdin</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">write</span><span style="color:#999999;--shiki-dark:#666666">((</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">s </span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#A65E2B;--shiki-dark:#C99076">\n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">).</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">encode</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">utf-8</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">))</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    p</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">stdin</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">flush</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">    while</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line </span><span style="color:#999999;--shiki-dark:#666666">:=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> p</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">stdout</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">readline</span><span style="color:#999999;--shiki-dark:#666666">():</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">        line </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">decode</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">        print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#B56959;--shiki-dark:#C98A7D">debug:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> end</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">""</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">        if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> endstr </span><span style="color:#AB5959;--shiki-dark:#CB7676">in</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> line</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">            print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">line</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> end</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">""</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">            break</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#A65E2B;--shiki-dark:#C99076">TOKEN</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">to quit the application</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">newgame</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">What</span><span style="color:#A65E2B;--shiki-dark:#C99076">\'</span><span style="color:#B56959;--shiki-dark:#C98A7D">s your name?</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">y</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">sleep</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">2</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">y</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">n</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">w</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">w</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">s</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">pickup: Pickup something.</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">getflag</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">========================================================================</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD"># æ¥ä¸‹æ¥éœ€è¦å¾ªç¯è®¡æ—¶ï¼Œç›´åˆ°é€€å‡º</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time_list </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> []</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">while</span><span style="color:#1E754F;--shiki-dark:#4D9375"> True</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    start </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    p_write</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">0</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">Wrong</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    end </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> time</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time</span><span style="color:#999999;--shiki-dark:#666666">()</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    time_list</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">append</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">end </span><span style="color:#AB5959;--shiki-dark:#CB7676">-</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> start</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">    print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">time_list</span><span style="color:#999999;--shiki-dark:#666666">)</span></span></code></pre>
<p>è·‘åˆ°æŠ¥é”™æ”¶é›†ä¸€ä¸‹ <code>time_list</code>ï¼Œç„¶åç”¨ 0.5 ç§’ä½œä¸ºé˜ˆå€¼ï¼Œå¤§äºé˜ˆå€¼å°±æ˜¯ 1ï¼Œå°äºé˜ˆå€¼å°±æ˜¯ 0ï¼Œæ‹¼æ¥èµ·æ¥åå…­è¿›åˆ¶å°±æ˜¯ flag çš„ ASCII ç äº†ã€‚</p>
<h2 id="%E9%BA%A6%E6%81%A9%C2%B7%E5%BA%93%E6%8B%89%E5%A4%AB%E7%89%B9" tabindex="-1">éº¦æ©Â·åº“æ‹‰å¤«ç‰¹</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-2" tabindex="-1">ç¬¬ä¸€é—®</h3>
<p>å‡ºç”Ÿç‚¹é™„è¿‘å‘Šç¤ºç‰Œã€‚</p>
<h3 id="%E7%AC%AC%E4%BA%8C%E9%97%AE-1" tabindex="-1">ç¬¬äºŒé—®</h3>
<p>æŸ¥çœ‹åœ°å›¾å­˜æ¡£å‘ç°æ–‡ä»¶åæ˜¯ <code>r.0.0.mca</code> çš„æ ¼å¼ï¼Œ<code>r.6.-4.mca</code> ä¸åˆ«çš„æ•°å­—ä¸è¿ç»­ä¸”æ–‡ä»¶å¤§å°è¾ƒå¤§ï¼Œå¯ä»¥çŒœæµ‹æœ‰ flagã€‚æœç´¢å‘ç°è¿™é‡Œä¸€ä¸ªå•ä½æ˜¯ 512 ä¸ªæ–¹å—ï¼Œæˆ‘ç”¨ Amulet å¯¼å‡ºäº†ä¸€ä¸‹å­˜æ¡£æ‰¾äº†ä¸‹å‘Šç¤ºç‰Œï¼Œå³ä¸º flagã€‚</p>
<h2 id="emoji-wordle" tabindex="-1">Emoji Wordle</h2>
<p>åˆ©ç”¨äº† Play framework æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥æ¯ä¸ª cookie ä½œä¸ºä¸€ä¸ªçŠ¶æ€éƒ½å¯ä»¥è¢« fork å‡ºæ— æ•°ä»½ï¼Œä¹Ÿå°±æ²¡æœ‰äº†å°è¯•æ•°é‡çš„é™åˆ¶ã€‚</p>
<p>ç¬¬ä¸‰é—®çš„è„šæœ¬å¯ä»¥è¦†ç›–å‰ä¸¤é—®ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ç¬¬ä¸‰é—®çš„è„šæœ¬å°±å¯ä»¥äº†ã€‚</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-python"><span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> requests</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> urllib</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">parse</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">import</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">cookie </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> {</span></span>
<span class="line"><span style="color:#B5695977;--shiki-dark:#C98A7D77">    "</span><span style="color:#B56959;--shiki-dark:#C98A7D">PLAY_SESSION</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> "</span><span style="color:#B56959;--shiki-dark:#C98A7D">......</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">"</span><span style="color:#A0ADA0;--shiki-dark:#758575DD"> # æ‰‹åŠ¨å»æµè§ˆå™¨å¤åˆ¶ä¸€ä¸‹å°±å¥½</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">}</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> [</span><span style="color:#998418;--shiki-dark:#B8A965">chr</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#1E754F;--shiki-dark:#4D9375"> for</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> i </span><span style="color:#1E754F;--shiki-dark:#4D9375">in</span><span style="color:#998418;--shiki-dark:#B8A965"> range</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">128016</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 128144</span><span style="color:#999999;--shiki-dark:#666666">)]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">def</span><span style="color:#59873A;--shiki-dark:#80A665"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">emojis</span><span style="color:#999999;--shiki-dark:#666666">:</span><span style="color:#998418;--shiki-dark:#B8A965"> str</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    emojis </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> urllib</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">parse</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">quote_plus</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">emojis</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    url </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#999999;--shiki-dark:#666666"> (</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">        f</span><span style="color:#B56959;--shiki-dark:#C98A7D">'https://prob14.geekgame.pku.edu.cn/level3?guess=</span><span style="color:#A65E2B;--shiki-dark:#C99076">{</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">emojis</span><span style="color:#A65E2B;--shiki-dark:#C99076">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">'</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#666666">    )</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    res </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> requests</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">get</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">url</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#B07D48;--shiki-dark:#BD976A"> cookies</span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">cookie</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">    text </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> res</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">text</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">    return</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> re</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">findall</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#AB5959;--shiki-dark:#CB7676">r</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5E3F;--shiki-dark:#C4704F">push</span><span style="color:#BDA437;--shiki-dark:#E6CC77">\(</span><span style="color:#AB5E3F;--shiki-dark:#C4704F">"</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#998418;--shiki-dark:#B8A965">.</span><span style="color:#2F798A;--shiki-dark:#4C9A91">+</span><span style="color:#999999;--shiki-dark:#666666">)</span><span style="color:#AB5E3F;--shiki-dark:#C4704F">"</span><span style="color:#BDA437;--shiki-dark:#E6CC77">\)</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">,</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> text</span><span style="color:#999999;--shiki-dark:#666666">)[</span><span style="color:#2F798A;--shiki-dark:#4C9A91">0</span><span style="color:#999999;--shiki-dark:#666666">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">res </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">0</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet_used </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">''</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">join</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">[:</span><span style="color:#2F798A;--shiki-dark:#4C9A91">64</span><span style="color:#999999;--shiki-dark:#666666">]))</span><span style="color:#AB5959;--shiki-dark:#CB7676"> +</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">''</span><span style="color:#999999;--shiki-dark:#666666">.</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">join</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#2F798A;--shiki-dark:#4C9A91">64</span><span style="color:#999999;--shiki-dark:#666666">:]))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">for</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> i </span><span style="color:#1E754F;--shiki-dark:#4D9375">in</span><span style="color:#998418;--shiki-dark:#B8A965"> range</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#998418;--shiki-dark:#B8A965">len</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">)):</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">    if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> alphabet_used</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> !=</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">ğŸŸ¥</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">        # find out its all occurences</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">        occurences </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> visit</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">alphabet</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> *</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 64</span><span style="color:#999999;--shiki-dark:#666666">)</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">        for</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> j </span><span style="color:#1E754F;--shiki-dark:#4D9375">in</span><span style="color:#998418;--shiki-dark:#B8A965"> range</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#2F798A;--shiki-dark:#4C9A91">64</span><span style="color:#999999;--shiki-dark:#666666">):</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#4D9375">            if</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> occurences</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">j</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ==</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">ğŸŸ©</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">:</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#DBD7CAEE">                res </span><span style="color:#999999;--shiki-dark:#666666">=</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> res</span><span style="color:#999999;--shiki-dark:#666666">[:</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">j</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> +</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> alphabet</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">i</span><span style="color:#999999;--shiki-dark:#666666">]</span><span style="color:#AB5959;--shiki-dark:#CB7676"> +</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE"> res</span><span style="color:#999999;--shiki-dark:#666666">[</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">j</span><span style="color:#AB5959;--shiki-dark:#CB7676">+</span><span style="color:#2F798A;--shiki-dark:#4C9A91">1</span><span style="color:#999999;--shiki-dark:#666666">:]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#998418;--shiki-dark:#B8A965">print</span><span style="color:#999999;--shiki-dark:#666666">(</span><span style="color:#393A34;--shiki-dark:#DBD7CAEE">res</span><span style="color:#999999;--shiki-dark:#666666">)</span></span></code></pre>
<p><code>alphabet</code> å­—æ¯è¡¨æ˜¯å¤šå¼€å‡ æ¬¡æ¸¸æˆï¼ŒæŠŠæ¯æ¬¡å‡ºç°çš„å­—ç¬¦åŠ å…¥æŸä¸ª <code>set</code> å°±èƒ½å¾—åˆ°äº†ã€‚</p>
<h2 id="%E7%AC%AC%E4%B8%89%E6%96%B0-xss" tabindex="-1">ç¬¬ä¸‰æ–° XSS</h2>
<p>è¿™é¢˜ç¬¬äºŒé˜¶æ®µæç¤ºç»™çš„å®åœ¨æ˜¯å¤ªå¤šäº†ã€‚ã€‚ã€‚</p>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-3" tabindex="-1">ç¬¬ä¸€é—®</h3>
<blockquote>
<p>ç»™ Cookie è®¾ç½® Path å¹¶ä¸èƒ½å¸¦æ¥å®‰å…¨æ€§ã€‚<a href="https://developer.mozilla.org/en-US/docs/web/api/document/cookie#security" target="_blank" rel="noopener">MDN æ–‡æ¡£</a> ä¸“é—¨æœ‰ä¸€èŠ‚æ¥æŒ‡å‡ºå…¶ä¸­çš„é—®é¢˜ã€‚</p>
</blockquote>
<p>æ‰€ä»¥å¼€ä¸ª <code>&lt;iframe&gt;</code> å°±å¥½ã€‚</p>
<h3 id="%E7%AC%AC%E4%BA%8C%E9%97%AE-2" tabindex="-1">ç¬¬äºŒé—®</h3>
<blockquote>
<p>ä½ éœ€è¦ <a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API/Using_Service_Workers" target="_blank" rel="noopener">æ³¨å†Œä¸€ä¸ª Service Worker</a>ï¼Œè€Œä¸”è¦æ³¨å†Œåˆ° &quot;/&quot; è¿™ä¸ª scope ä¸Šã€‚</p>
</blockquote>
<p>æ‰€ä»¥æ³¨å†Œä¸€ä¸‹ Service Workerï¼Œç„¶ååœ¨ Service Worker é‡Œé¢æ‹¦æˆªå¯¹ &quot;/admin&quot; çš„è¯·æ±‚å³å¯ã€‚ä¼šé‡åˆ°ä¸€äº›å“åº”å¤´çš„å°é—®é¢˜ï¼Œçœ‹æŠ¥é”™æç¤ºä¿®å¤å°±å¥½äº†ã€‚</p>
<h2 id="%E7%AE%80%E5%8D%95%E7%9A%84%E6%89%93%E5%AD%97%E7%A8%BF" tabindex="-1">ç®€å•çš„æ‰“å­—ç¨¿</h2>
<p>éœ€è¦æå– TypeScript ç±»å‹ä¸­çš„ flagã€‚</p>
<p>ç”±äºç¼–è¯‘åˆ° JavaScript åï¼Œæ‰€æœ‰çš„ç±»å‹éƒ½ä¼šè¢«æ“¦é™¤ï¼Œæ‰€ä»¥éœ€è¦åœ¨ç¼–è¯‘æ—¶ç”¨æŠ¥é”™æå–ã€‚</p>
<pre class="shiki shiki-themes vitesse-light vitesse-dark" style="background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee" tabindex="0"><code class="language-typescript"><span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> flag1</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> '</span><span style="color:#B56959;--shiki-dark:#C98A7D">flag{...}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> flag2</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#AB5959;--shiki-dark:#CB7676"> object</span><span style="color:#999999;--shiki-dark:#666666"> |</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#999999;--shiki-dark:#666666">():</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#59873A;--shiki-dark:#80A665"> v</span><span style="color:#999999;--shiki-dark:#666666">: () => (</span><span style="color:#59873A;--shiki-dark:#80A665">a</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">a</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">b</span><span style="color:#999999;--shiki-dark:#666666">: { </span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#B56959;--shiki-dark:#C98A7D">flag{...}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">'</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">never</span><span style="color:#999999;--shiki-dark:#666666"> } &#x26; </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">>) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">never</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666"> }</span><span style="color:#999999;--shiki-dark:#666666"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractStringFlag</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">T</span><span style="color:#999999;--shiki-dark:#666666">></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> T</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> `</span><span style="color:#B56959;--shiki-dark:#C98A7D">flag</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type1</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractStringFlag</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">flag1</span><span style="color:#999999;--shiki-dark:#666666">>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractObject</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">T</span><span style="color:#999999;--shiki-dark:#666666">></span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> T</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#AB5959;--shiki-dark:#CB7676"> new</span><span style="color:#999999;--shiki-dark:#666666">():</span><span style="color:#999999;--shiki-dark:#666666"> {</span><span style="color:#59873A;--shiki-dark:#80A665"> v</span><span style="color:#999999;--shiki-dark:#666666">: () => (</span><span style="color:#59873A;--shiki-dark:#80A665">a</span><span style="color:#999999;--shiki-dark:#666666">: (</span><span style="color:#B07D48;--shiki-dark:#BD976A">a</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#B07D48;--shiki-dark:#BD976A">b</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#999999;--shiki-dark:#666666"> &#x26; </span><span style="color:#2E8F82;--shiki-dark:#5DA994">Record</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">, </span><span style="color:#2E8F82;--shiki-dark:#5DA994">string</span><span style="color:#999999;--shiki-dark:#666666">>) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">never</span><span style="color:#999999;--shiki-dark:#666666">) => </span><span style="color:#2E8F82;--shiki-dark:#5DA994">unknown</span><span style="color:#999999;--shiki-dark:#666666"> }</span><span style="color:#999999;--shiki-dark:#666666"> }</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type2</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractStringFlag</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#AB5959;--shiki-dark:#CB7676">keyof</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> ExtractObject</span><span style="color:#999999;--shiki-dark:#666666">&#x3C;</span><span style="color:#2E8F82;--shiki-dark:#5DA994">flag2</span><span style="color:#999999;--shiki-dark:#666666">>>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// flag2 ç±»ä¼¼ flag{...flag...} æ ¼å¼</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// å› æ­¤ type2 æ˜¯ {...flag...} æ ¼å¼</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// é¢˜ç›®é™åˆ¶äº†è¾“å‡ºä¸èƒ½æœ‰ flagï¼Œæ‰€ä»¥å¤„ç†ä¸€ä¸‹</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type2</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> `</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">f</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">type</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> type2</span><span style="color:#AB5959;--shiki-dark:#CB7676"> extends</span><span style="color:#B5695977;--shiki-dark:#C98A7D77"> `</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> L</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B56959;--shiki-dark:#C98A7D">f</span><span style="color:#1E754F;--shiki-dark:#4D9375">${</span><span style="color:#AB5959;--shiki-dark:#CB7676">infer</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#1E754F;--shiki-dark:#4D9375">}</span><span style="color:#B5695977;--shiki-dark:#C98A7D77">`</span><span style="color:#AB5959;--shiki-dark:#CB7676"> ?</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> R</span><span style="color:#AB5959;--shiki-dark:#CB7676"> :</span><span style="color:#2E8F82;--shiki-dark:#5DA994"> never</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#758575DD">// ä»¥ä¸‹è§¦å‘æŠ¥é”™ï¼Œè¾“å‡ºä¸èƒ½å¤ªé•¿ï¼Œæ‰€ä»¥æ¯æ¬¡é€‰ä¸€ä¸ªå°±å¥½</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let </span><span style="color:#B07D48;--shiki-dark:#BD976A">a</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">type1</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let </span><span style="color:#B07D48;--shiki-dark:#BD976A">b</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">L</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">;</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#CB7676">let </span><span style="color:#B07D48;--shiki-dark:#BD976A">c</span><span style="color:#999999;--shiki-dark:#666666">: </span><span style="color:#2E8F82;--shiki-dark:#5DA994">R</span><span style="color:#999999;--shiki-dark:#666666"> =</span><span style="color:#2F798A;--shiki-dark:#4C9A91"> 1</span><span style="color:#999999;--shiki-dark:#666666">;</span></span></code></pre>
<h2 id="%E9%80%9D%E7%95%8C%E8%AE%A1%E5%88%92" tabindex="-1">é€ç•Œè®¡åˆ’</h2>
<p>åˆ©ç”¨ <a href="https://www.home-assistant.io/" target="_blank" rel="noopener">Home Assistant</a> çš„æ¼æ´è¯»å–è¿œç¨‹ç£ç›˜ä¸Šçš„ <code>/flag.txt</code>ã€‚</p>
<p>æç¤ºé™å®šäº† nmap é›†æˆåå°±å¾ˆç®€å•äº†ã€‚æ·»åŠ  nmap é›†æˆï¼Œå‘ç°å¯ä»¥è‡ªå®šä¹‰å®ƒçš„å‚æ•°ï¼Œè¾“å…¥è®¾ç½®æˆ <code>/flag.txt</code>ï¼Œè¾“å‡ºè®¾ç½®æˆ Home Assistant çš„æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åç­‰å¾… nmap è¿è¡Œï¼Œå°±èƒ½åœ¨æ—¥å¿—æ–‡ä»¶ä¸­çœ‹åˆ° flag äº†ã€‚</p>
<h2 id="%E9%9D%9E%E6%B3%95%E6%89%80%E5%BE%97" tabindex="-1">éæ³•æ‰€å¾—</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E9%97%AE-4" tabindex="-1">ç¬¬ä¸€é—®</h3>
<p>è‡ªå®šä¹‰ clash é…ç½®æ–‡ä»¶çš„ proxy-providers å¯¼å…¥æœ¬åœ°çš„ <code>/app/profiles/flag.yml</code> å°±å¥½ã€‚</p>
<h2 id="%E6%B1%89%E5%8C%96%E7%BB%BF%E8%89%B2%E7%89%88%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD" tabindex="-1">æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½</h2>
<p>kirikiri è§£åŒ…ã€‚éœ€è¦æ³¨æ„æœ‰ä¸ªæ–‡ä»¶è®°å½•äº†æ‰€æœ‰é€‰é¡¹çš„é€‰æ‹©æ¬¡æ•°ã€‚</p>
<p>åé¢é¢˜ç›®æ˜¯ binary å’Œ algoï¼Œå‡ ä¹æ²¡æœ‰å®Œæ•´åšå‡ºæ¥ï¼Œå°±ä¸å†™äº†ã€‚</p>
