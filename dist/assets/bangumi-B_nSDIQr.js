import{L as e}from"./loading-loop_width_48px_height_48px-RKKgy41S.js";import{H as t,q as n,k as a,l,I as r,J as s,K as o,n as i,L as c,M as u,t as d,N as m,b as f,O as v,P as h,Q as p,x as g,R as b,S as y,T as x,U as w,c as _,a as k,F as C,v as j,r as z,V as M,D as L,o as $,z as V}from"./index-C_6fBbrq.js";import{u as A,a as I,N as F}from"./Icon-B_69eV54.js";const N={name:"Rate",common:t,self:function(e){const{railColor:t}=e;return{itemColor:t,itemColorActive:"#FFCC33",sizeSmall:"16px",sizeMedium:"20px",sizeLarge:"24px"}}},R=n("svg",{viewBox:"0 0 512 512"},n("path",{d:"M394 480a16 16 0 01-9.39-3L256 383.76 127.39 477a16 16 0 01-24.55-18.08L153 310.35 23 221.2a16 16 0 019-29.2h160.38l48.4-148.95a16 16 0 0130.44 0l48.4 149H480a16 16 0 019.05 29.2L359 310.35l50.13 148.53A16 16 0 01394 480z"})),S=a("rate",{display:"inline-flex",flexWrap:"nowrap"},[l("&:hover",[r("item","\n transition:\n transform .1s var(--n-bezier),\n color .3s var(--n-bezier);\n ")]),r("item","\n position: relative;\n display: flex;\n transition:\n transform .1s var(--n-bezier),\n color .3s var(--n-bezier);\n transform: scale(1);\n font-size: var(--n-item-size);\n color: var(--n-item-color);\n ",[l("&:not(:first-child)","\n margin-left: 6px;\n "),s("active","\n color: var(--n-item-color-active);\n ")]),o("readonly","\n cursor: pointer;\n ",[r("item",[l("&:hover","\n transform: scale(1.05);\n "),l("&:active","\n transform: scale(0.96);\n ")])]),r("half","\n display: flex;\n transition: inherit;\n position: absolute;\n top: 0;\n left: 0;\n bottom: 0;\n width: 50%;\n overflow: hidden;\n color: rgba(255, 255, 255, 0);\n ",[s("active","\n color: var(--n-item-color-active);\n ")])]),P=i({name:"Rate",props:Object.assign(Object.assign({},u.props),{allowHalf:Boolean,count:{type:Number,default:5},value:Number,defaultValue:{type:Number,default:null},readonly:Boolean,size:{type:[String,Number],default:"medium"},clearable:Boolean,color:String,onClear:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array]}),setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:n}=c(e),a=u("Rate","-rate",S,N,e,t),l=d(e,"value"),r=m(e.defaultValue),s=m(null),o=A(e),i=I(l,r);function g(e,t){return t.offsetX>=Math.floor(t.currentTarget.offsetWidth/2)?e+1:e+.5}let y=!1;const x=f((()=>{const{size:t}=e,{self:n}=a.value;return"number"==typeof t?`${t}px`:n[v("size",t)]})),w=f((()=>{const{common:{cubicBezierEaseInOut:t},self:n}=a.value,{itemColor:l,itemColorActive:r}=n,{color:s}=e;return{"--n-bezier":t,"--n-item-color":l,"--n-item-color-active":s||r,"--n-item-size":x.value}})),_=n?h("rate",f((()=>{const t=x.value,{color:n}=e;let a="";return t&&(a+=t[0]),n&&(a+=p(n)),a})),w,e):void 0;return{mergedClsPrefix:t,mergedValue:i,hoverIndex:s,handleMouseMove:function(e,t){y||(s.value=g(e,t))},handleClick:function(t,n){!function(t){const{"onUpdate:value":n,onUpdateValue:a}=e,{nTriggerFormChange:l,nTriggerFormInput:s}=o;n&&b(n,t),a&&b(a,t),r.value=t,l(),s()}(g(t,n))},handleMouseLeave:function(){s.value=null},handleMouseEnterSomeStar:function(){y=!1},cssVars:n?void 0:w,themeClass:null==_?void 0:_.themeClass,onRender:null==_?void 0:_.onRender}},render(){const{readonly:e,hoverIndex:t,mergedValue:a,mergedClsPrefix:l,onRender:r,$slots:{default:s}}=this;return null==r||r(),n("div",{class:[`${l}-rate`,{[`${l}-rate--readonly`]:e},this.themeClass],style:this.cssVars,onMouseleave:this.handleMouseLeave},g(this.count,((r,o)=>{const i=s?s({index:o}):n(F,{clsPrefix:l},{default:()=>R}),c=null!==t?o+1<=t:o+1<=(a||0);return n("div",{key:o,class:[`${l}-rate__item`,c&&`${l}-rate__item--active`],onClick:e?void 0:e=>{this.handleClick(o,e)},onMouseenter:this.handleMouseEnterSomeStar,onMousemove:e?void 0:e=>{this.handleMouseMove(o,e)}},i,n("div",{class:[`${l}-rate__half`,{[`${l}-rate__half--active`]:c||null===t?o+.5<=(a||0):o+.5<=t}]},i))})))}}),E=12,T=m([]);let B=0;const O=m(!0);let U=!1;async function H(){!U&&O.value&&(U=!0,await async function(){try{await async function(e){const t=e*E,n=await fetch(`https://bgm.liuly.moe/v0/users/charlottechen/collections?subject_type=2&type=2&limit=${E}&offset=${t}`);if(!n.ok)throw new Error("Network response was not ok");const a=await n.json(),l=a.total;if(T.value=T.value.concat(a.data.map((e=>{const t=y(e.updated_at);return{...e,updated_at:t}}))),t+a.data.length>=l)throw new Error("No more data")}(B),B++}catch(e){O.value=!1}}(),U=!1)}const W=k("h1",{class:"text-3xl font-bold"}," Anime List ",-1),D=k("p",{class:"mt-5"},[L(" The anime I have watched and rated on "),k("a",{href:"https://bangumi.tv/user/charlottechen",class:"blue-link",target:"_blank",rel:"noopener noreferrer"},"bangumi"),L(". ")],-1),q={class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 mt-5"},J=["href"],K=["src","alt"],Q={class:"h-full ml-2 flex flex-col justify-between flex-grow text-sm"},X=["href"],G=k("hr",null,null,-1),Y=i({__name:"bangumi",setup(t){const{animeList:n,loading:a,updateAnimeList:l}={animeList:T,loading:O,updateAnimeList:H},r=m(),s=new IntersectionObserver((([e])=>{e.isIntersecting&&l()}));function o(e){var t;const n=e.target,a=null==(t=Array.from(n.classList).find((e=>e.startsWith("line-clamp-"))))?void 0:t.split("-")[2];if(a){const e=n.style.getPropertyValue("-webkit-line-clamp")||a;n.style.setProperty("-webkit-line-clamp",e===a?"unset":a)}}return x((()=>{r.value&&s.observe(r.value)})),w((()=>{s.disconnect()})),(t,l)=>{const s=P;return $(),_(C,null,[W,D,k("div",q,[($(!0),_(C,null,g(j(n),(e=>($(),_("div",{key:e.subject.id,class:"flex items-center card p-3"},[k("a",{class:"flex-shrink-0",href:`https://bgm.tv/subject/${e.subject.id}`,target:"_blank",rel:"noopener noreferrer"},[k("img",{src:e.subject.images.medium,alt:e.subject.name,class:"rounded-lg",width:"130",height:"182"},null,8,K)],8,J),k("div",Q,[k("a",{href:`https://bgm.tv/subject/${e.subject.id}`,target:"_blank",rel:"noopener noreferrer",class:"text-lg blue-link font-bold hover:underline"},V(e.subject.name_cn||e.subject.name),9,X),k("div",{class:"cursor-pointer line-clamp-2 text-gray-500 my-2 whitespace-pre-line",onClick:o},V(e.subject.short_summary),1),G,e.comment?($(),_("div",{key:0,class:"cursor-pointer line-clamp-3 my-2",onClick:o},V(e.comment),1)):M("",!0),k("div",null,[z(s,{"default-value":e.rate/2,readonly:"","allow-half":""},null,8,["default-value"])])])])))),128))]),j(a)?($(),_("div",{key:0,ref_key:"loadingElement",ref:r,class:"pt-5"},[z(j(e),{style:{color:"#18a058"}})],512)):M("",!0)],64)}}});export{Y as default};
